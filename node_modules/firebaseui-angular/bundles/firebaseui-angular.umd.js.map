{"version":3,"file":"firebaseui-angular.umd.js","sources":["ng://firebaseui-angular/lib/firebaseui-angular-library.service.ts","ng://firebaseui-angular/lib/firebaseui-angular-library.component.ts","ng://firebaseui-angular/lib/firebaseui-angular-library.helper.ts","ng://firebaseui-angular/lib/firebaseui-angular-library.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport {AngularFireAuth} from '@angular/fire/auth';\nimport * as firebaseui from 'firebaseui';\n\n@Injectable()\nexport class FirebaseuiAngularLibraryService {\n  public firebaseUiInstance: firebaseui.auth.AuthUI;\n\n  constructor(angularFireAuth: AngularFireAuth) {\n    // store the firebaseui instance on the window object to prevent double initialization\n    if (!(<any>window).firebaseUiInstance) {\n      (<any>window).firebaseUiInstance = new firebaseui.auth.AuthUI(angularFireAuth.auth);\n    }\n    this.firebaseUiInstance = (<any>window).firebaseUiInstance as firebaseui.auth.AuthUI;\n  }\n}\n","import {Component, EventEmitter, Inject, NgZone, OnDestroy, OnInit, Output} from '@angular/core';\nimport {AngularFireAuth} from '@angular/fire/auth';\nimport {Subscription} from 'rxjs';\nimport {\n  FirebaseUISignInFailure,\n  FirebaseUISignInSuccessWithAuthResult,\n  NativeFirebaseUIAuthConfig,\n} from './firebaseui-angular-library.helper';\nimport * as firebaseui from 'firebaseui';\nimport {User} from 'firebase/app';\nimport {FirebaseuiAngularLibraryService} from './firebaseui-angular-library.service';\nimport 'firebase/auth';\nimport UserCredential = firebase.auth.UserCredential;\n\n@Component({\n  selector: 'firebase-ui',\n  template: '<div id=\"firebaseui-auth-container\"></div>'\n})\nexport class FirebaseuiAngularLibraryComponent implements OnInit, OnDestroy {\n  private static readonly COMPUTED_CALLBACKS = 'COMPUTED_CALLBACKS';\n\n  @Output('signInSuccessWithAuthResult') signInSuccessWithAuthResultCallback: EventEmitter<FirebaseUISignInSuccessWithAuthResult> = new EventEmitter(); // tslint:disable-line\n  @Output('signInFailure') signInFailureCallback: EventEmitter<FirebaseUISignInFailure> = new EventEmitter(); // tslint:disable-line\n\n  private subscription: Subscription;\n\n  constructor(private angularFireAuth: AngularFireAuth,\n              @Inject('firebaseUIAuthConfig') private _firebaseUiConfig: NativeFirebaseUIAuthConfig,\n              @Inject('firebaseUIAuthConfigFeature') private _firebaseUiConfig_Feature: NativeFirebaseUIAuthConfig,\n              private ngZone: NgZone,\n              private firebaseUIService: FirebaseuiAngularLibraryService) {\n  }\n\n  get firebaseUiConfig(): NativeFirebaseUIAuthConfig {\n    return {\n      ...this._firebaseUiConfig,\n      ...this._firebaseUiConfig_Feature\n    } as NativeFirebaseUIAuthConfig;\n  }\n\n  ngOnInit(): void {\n    this.subscription = this.angularFireAuth.authState.subscribe((value: User) => {\n      if ((value && value.isAnonymous) || !value) {\n        if (this.firebaseUiConfig.signInOptions.length !== 0) {\n          this.firebaseUIPopup();\n        } else {\n          throw new Error('There must be at least one AuthProvider.');\n        }\n      }\n    });\n  }\n\n  ngOnDestroy(): void {\n    if (!!this.subscription) {\n      this.subscription.unsubscribe();\n    }\n  }\n\n  private getUIAuthConfig(): NativeFirebaseUIAuthConfig {\n    if (!(this.firebaseUiConfig as NativeFirebaseUIAuthConfig).callbacks) {\n      this._firebaseUiConfig[FirebaseuiAngularLibraryComponent.COMPUTED_CALLBACKS] = true;\n      (this._firebaseUiConfig as NativeFirebaseUIAuthConfig).callbacks = this.getCallbacks();\n    }\n    return (this.firebaseUiConfig as NativeFirebaseUIAuthConfig);\n  }\n\n  private firebaseUIPopup() {\n    const firebaseUiInstance = this.firebaseUIService.firebaseUiInstance;\n    const uiAuthConfig = this.getUIAuthConfig();\n\n    // Check if callbacks got computed to reset them again after providing the to firebaseui.\n    // Necessary for allowing updating the firebaseui config during runtime.\n    let resetCallbacks = false;\n    if (uiAuthConfig[FirebaseuiAngularLibraryComponent.COMPUTED_CALLBACKS]) {\n      resetCallbacks = true;\n      delete uiAuthConfig[FirebaseuiAngularLibraryComponent.COMPUTED_CALLBACKS];\n    }\n\n    // show the firebaseui\n    firebaseUiInstance.start('#firebaseui-auth-container', uiAuthConfig);\n\n    if (resetCallbacks) {\n      (this._firebaseUiConfig as NativeFirebaseUIAuthConfig).callbacks = null;\n    }\n  }\n\n  private getCallbacks(): any {\n    const signInSuccessWithAuthResult = (authResult: UserCredential, redirectUrl) => {\n      this.ngZone.run(() => {\n        this.signInSuccessWithAuthResultCallback.emit({\n          authResult,\n          redirectUrl\n        });\n      });\n      return this.firebaseUiConfig.signInSuccessUrl;\n    };\n\n    const signInFailureCallback = (error: firebaseui.auth.AuthUIError) => {\n      this.ngZone.run(() => {\n        this.signInFailureCallback.emit({\n          code: error.code,\n          credential: error.credential\n        });\n      });\n      return Promise.reject();\n    };\n\n    return {\n      signInSuccessWithAuthResult: signInSuccessWithAuthResult,\n      signInFailure: signInFailureCallback,\n    };\n  }\n}\n","/*\n * Created by Raphael Jenni\n * Copyright (c) 2017 Raphael Jenni\n */\n\nimport * as firebaseOriginal from 'firebase/app';\nimport UserCredential = firebase.auth.UserCredential;\nimport * as firebaseuiOriginal from 'firebaseui';\n\nexport const firebase = firebaseOriginal;\nexport const firebaseui = firebaseuiOriginal;\n\nexport type NativeFirebaseUIAuthConfig = firebaseuiOriginal.auth.Config;\n\n\nexport class FirebaseUISignInSuccessWithAuthResult {\n  authResult: UserCredential;\n  redirectUrl: string;\n}\n\nexport class FirebaseUISignInFailure {\n  code: string;\n  credential: firebaseOriginal.auth.AuthCredential;\n}\n","import {ModuleWithProviders, NgModule} from '@angular/core';\nimport {FirebaseuiAngularLibraryComponent} from './firebaseui-angular-library.component';\nimport {CommonModule} from '@angular/common';\nimport {NativeFirebaseUIAuthConfig} from './firebaseui-angular-library.helper';\nimport {FirebaseuiAngularLibraryService} from './firebaseui-angular-library.service';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  declarations: [FirebaseuiAngularLibraryComponent],\n  providers: [FirebaseuiAngularLibraryService],\n  exports: [FirebaseuiAngularLibraryComponent]\n})\nexport class FirebaseUIModule {\n  static forRoot(firebaseUiAuthConfig: NativeFirebaseUIAuthConfig): ModuleWithProviders {\n    return {\n      ngModule: FirebaseUIModule,\n      providers: [\n        {provide: 'firebaseUIAuthConfig', useValue: firebaseUiAuthConfig},\n        {provide: 'firebaseUIAuthConfigFeature', useValue: {}}\n      ]\n    };\n  }\n\n  static forFeature(firebaseUIAuthConfig: NativeFirebaseUIAuthConfig | any): ModuleWithProviders {\n    return {\n      ngModule: FirebaseUIModule,\n      providers: [\n        {provide: 'firebaseUIAuthConfigFeature', useValue: firebaseUIAuthConfig}\n      ]\n    };\n  }\n}\n"],"names":["firebaseui.auth","Injectable","AngularFireAuth","EventEmitter","Component","Inject","NgZone","Output","firebaseuiOriginal","NgModule","CommonModule"],"mappings":"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"}